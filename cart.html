
<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BuildCore - Your Construction Companion</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">

    <!-- jQuery CDN -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha384-oWBQ7fmgRox+7NQK9nZNNbfFLmTVsf5AIUV5h5Q5kVD7zM7N20N2kR2xD3+pxyze" crossorigin="anonymous"></script>
</head>
<body>
    <!-- Main Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="index.html">
                <img src="images/logo.jpeg" alt="BuildCore Logo" width="50" height="50" class="rounded-circle me-2">
                <span>BuildCore</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavMain">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavMain">
                <ul class="navbar-nav ms-auto align-items-center">
                    <li class="nav-item">
                        <a class="nav-link active d-flex align-items-center" href="index.php">
                            <i class="fas fa-home me-1"></i> Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center" href="cart.html">
                            <i class="fas fa-shopping-cart me-1"></i> Order here
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center" href="ai.html">
                            <i class="fas fa-robot me-1"></i> AI Estimation
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center" href="contact.html">
                            <i class="fas fa-envelope me-1"></i> Contact
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center" href="admin_dashboard.php">
                            <i class="fas fa-user-shield me-1"></i> Admin
                        </a>
                    </li>
                    <li class="nav-item ms-3">
                        <div class="input-group">
                            <input type="text" id="searchBar" placeholder="Search..." class="form-control">
                            <button id="searchButton" class="btn btn-outline-light">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
<!-- Include Bootstrap 5 (CDN) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
<!-- Improved Cart Section -->
<section class="container my-5">
    <div class="card shadow-xl border-0 rounded-4 overflow-hidden">
        <div class="card-header bg-gradient-primary text-white text-center py-4">
            <h2 class="fw-bold mb-0"><i class="fas fa-shopping-cart me-2"></i>Your Cart</h2>
        </div>
        <div class="card-body p-4">
            <div class="table-responsive">
                <table id="cartTable" class="table table-hover align-middle text-center">
                    <thead class="table-dark">
                        <tr>
                            <th>Image</th>
                            <th>Name</th>
                            <th>Material</th>
                            <th>Qty</th>
                            <th>Unit Price</th>
                            <th>Total</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Concrete Block -->
                        <tr>
                            <td><img src="images/concrete_block.jpg" alt="Concrete Blocks" class="img-fluid rounded" width="70"></td>
                            <td>Concrete Block</td>
                            <td>
                                <select class="form-select material-type" data-product-id="1" onchange="updatePrice(this)">
                                    <option value="70">A2 (16\"x6\"x8") - ₨70</option>
                                    <option value="65">A3 (12\"x5\"x8") - ₨65</option>
                                    <option value="40">A4 (12\"x4\"x8") - ₨40</option>
                                    <option value="35">A5 (16\"x3\"x8") - ₨35</option>
                                </select>
                            </td>
                            <td><input type="number" value="0" min="1" class="form-control quantity" onchange="updateTotal(this)"></td>
                            <td class="unit-price fw-semibold text-primary">₨70</td>
                            <td class="total-price fw-bold text-success">₨70</td>
                            <td><button class="btn btn-danger btn-sm" onclick="removeItem(this)"><i class="fas fa-trash"></i></button></td>
                        </tr>
                        <!-- Cement -->
                        <tr>
                            <td><img src="images/cement.jpg" alt="Cement" class="img-fluid rounded" width="70"></td>
                            <td>Cement</td>
                            <td>
                                <select class="form-select material-type" data-product-id="2" onchange="updatePrice(this)">
                                    <option value="1465">Kohat Cement - ₨1,465</option>
                                    <option value="1460">Cherat Cement - ₨1,460</option>
                                    <option value="1475">Maple Leaf Cement - ₨1,475</option>
                                    <option value="1460">Power Cement - ₨1,460</option>
                                </select>
                            </td>
                            <td><input type="number" value="0" min="1" class="form-control quantity" onchange="updateTotal(this)"></td>
                            <td class="unit-price fw-semibold text-primary">₨1,465</td>
                            <td class="total-price fw-bold text-success">₨1,465</td>
                            <td><button class="btn btn-danger btn-sm" onclick="removeItem(this)"><i class="fas fa-trash"></i></button></td>
                        </tr>
                        <!-- Iron Rod -->
                        <tr>
                            <td><img src="images/iron.jpg" alt="Iron Rod" class="img-fluid rounded" width="70"></td>
                            <td>Iron Rod</td>
                            <td>
                                <select class="form-select material-type" data-product-id="3" onchange="updatePrice(this)">
                                    <option value="258">3 Sutar (10mm) - ₨258</option>
                                    <option value="256">4 Sutar (12mm) - ₨256</option>
                                    <option value="256">5 Sutar (16mm) - ₨256</option>
                                    <option value="256">6 Sutar (20mm) - ₨256</option>
                                </select>
                            </td>
                            <td><input type="number" value="0" min="1" class="form-control quantity" onchange="updateTotal(this)"></td>
                            <td class="unit-price fw-semibold text-primary">₨258</td>
                            <td class="total-price fw-bold text-success">₨258</td>
                            <td><button class="btn btn-danger btn-sm" onclick="removeItem(this)"><i class="fas fa-trash"></i></button></td>
                        </tr>
                        <!-- Bricks -->
                        <tr>
                            <td><img src="images/bricks.jpg" alt="Bricks" class="img-fluid rounded" width="70"></td>
                            <td>Bricks</td>
                            <td>
                                <select class="form-select material-type" data-product-id="4" onchange="updatePrice(this)">
                                    <option value="17">A Class Brick - ₨17</option>
                                    <option value="16">Awwal Brick (Machine-Made) - ₨16</option>
                                    <option value="18">Fly Ash Brick - ₨18</option>
                                </select>
                            </td>
                            <td><input type="number" value="0" min="1" class="form-control quantity" onchange="updateTotal(this)"></td>
                            <td class="unit-price fw-semibold text-primary">₨17</td>
                            <td class="total-price fw-bold text-success">₨17</td>
                            <td><button class="btn btn-danger btn-sm" onclick="removeItem(this)"><i class="fas fa-trash"></i></button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        
    </div>
</section>

<!-- Enhanced Place Order Section -->
<section class="container my-5">
    <div class="card shadow-xl border-0 rounded-4 overflow-hidden">
        <div class="card-header bg-gradient-primary text-white text-center py-4">
            <h2 class="fw-bold mb-0"><i class="fas fa-receipt me-2"></i> Place Your Order</h2>
        </div>
        <div class="card-body p-4">
            <form id="orderForm" method="POST" action="place_order.php" onsubmit="return validateForm()">
                <div class="mb-4">
                    <h4 class="text-primary"><i class="fas fa-user me-2"></i>Customer Info</h4>
                    <input type="text" id="customerName" name="customer_name" class="form-control mb-3" placeholder="Full Name" required>
                    <input type="text" id="customerPhone" name="customer_phone" class="form-control mb-3" placeholder="Phone Number" required>
                    <input type="email" id="customerEmail" name="customer_email" class="form-control mb-3" placeholder="Email Address" required>
                    <textarea id="feedbackMessage" name="feedback_message" class="form-control mb-3" rows="3" placeholder="Your Feedback..." required></textarea>
                </div>

                <div class="order-summary p-4 bg-light rounded-3 shadow-sm">
                    <h4 class="text-success"><i class="fas fa-shopping-basket me-2"></i>Order Summary</h4>
                    <ul class="list-group mb-3">
                        <li class="list-group-item d-flex justify-content-between"><span>Subtotal</span><strong id="subtotal">₨20,793</strong></li>
                        <li class="list-group-item d-flex justify-content-between"><span>Delivery Charges</span><strong id="delivery">₨100</strong></li>
                        <li class="list-group-item d-flex justify-content-between bg-warning"><span class="fw-bold">Total</span><strong class="text-danger" id="totalCost">₨20,893</strong></li>
                    </ul>
                    <input type="hidden" id="orderItems" name="order_items">
                    <input type="hidden" id="totalOrderCost" name="totalCost">
                </div>
            </form>
        </div>
        <div class="card-footer text-center bg-light p-3">
            <button type="button" class="btn btn-primary btn-lg me-2 shadow" onclick="confirmOrder()"><i class="fas fa-check-circle"></i> Place Order</button>
            <button type="button" class="btn btn-secondary btn-lg me-2 shadow" onclick="printOrder()"><i class="fas fa-print"></i> Print</button>
            <button type="button" class="btn btn-info btn-lg shadow" onclick="downloadOrder()"><i class="fas fa-download"></i> Download</button>
        </div>
    </div>
</section>

<footer class="bg-dark text-white text-center py-3 mt-5">
    <p class="mb-0">&copy; 2024 <strong>BuildCore</strong>. All Rights Reserved.</p>
</footer>

<!-- Bootstrap 5 & FontAwesome -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


<script>
        // Function to validate the form before submission
        function validateForm() {
            const customerName = document.getElementById("customerName").value.trim();
            const customerPhone = document.getElementById("customerPhone").value.trim();
            const customerEmail = document.getElementById("customerEmail").value.trim();
            const feedbackMessage = document.getElementById("feedbackMessage").value.trim();

            if (!customerName || !customerPhone || !customerEmail || !feedbackMessage) {
                alert("Please fill out all customer details before placing the order.");
                return false;
            }

            return true;
        }

        // Function to update the total price for a single product
        function updateTotal(input) {
            const row = input.closest("tr");
            const unitPrice = parseFloat(row.querySelector(".unit-price").innerText.replace("₨", ""));
            const quantity = parseInt(input.value);
            const totalPrice = unitPrice * quantity;
            row.querySelector(".total-price").innerText = `₨${totalPrice.toFixed(2)}`;
            updateSummary();
        }

        // Function to update the unit price based on material type
        function updatePrice(select) {
            const row = select.closest("tr");
            const unitPrice = parseFloat(select.value);
            row.querySelector(".unit-price").innerText = `₨${unitPrice}`;
            const quantity = parseInt(row.querySelector(".quantity").value);
            const totalPrice = unitPrice * quantity;
            row.querySelector(".total-price").innerText = `₨${totalPrice.toFixed(2)}`;
            updateSummary();
        }

        // Function to update the order summary
        function updateSummary() {
            let subtotal = 0;
            document.querySelectorAll(".total-price").forEach(price => {
                subtotal += parseFloat(price.innerText.replace("₨", ""));
            });
            const delivery = 100; // Fixed delivery charge
            const totalCost = subtotal + delivery;

            document.getElementById("subtotal").innerText = `₨${subtotal.toFixed(2)}`;
            document.getElementById("delivery").innerText = `₨${delivery.toFixed(2)}`;
            document.getElementById("totalCost").innerText = `₨${totalCost.toFixed(2)}`;
            document.getElementById("totalOrderCost").value = totalCost.toFixed(2);
        }

        // Function to remove a product from the cart
        function removeItem(button) {
            button.closest("tr").remove();
            updateSummary();
        }

        // Function to print the order
        function printOrder() {
            const orderContent = document.querySelector(".cart-section").innerHTML;
            const newWindow = window.open("", "", "width=800,height=600");
            newWindow.document.write(orderContent);
            newWindow.document.close();
            newWindow.print();
        }

        // Function to download the order as a text file
        function downloadOrder() {
            const orderDetails = document.querySelector(".cart-section").innerText;
            const blob = new Blob([orderDetails], { type: "text/plain" });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "order-details.txt";
            link.click();
        }

        // Function to handle order confirmation
        function confirmOrder() {
            const confirmation = confirm("Are you sure you want to place this order?");
            if (confirmation) {
                handleOrderSubmission();
            }
        }

        // Function to handle order submission
        function handleOrderSubmission() {
            const orderItems = [];

            document.querySelectorAll("#cartTable tbody tr").forEach(row => {
                const productId = row.querySelector(".material-type").dataset.productId;
                const productName = row.querySelector("td:nth-child(2)").innerText;
                const materialType = row.querySelector(".material-type").selectedOptions[0].text.split(' - ')[0];
                const quantity = row.querySelector(".quantity").value;
                const unitPrice = parseFloat(row.querySelector(".unit-price").innerText.replace("₨", ""));
                const totalPrice = parseFloat(row.querySelector(".total-price").innerText.replace("₨", ""));

                orderItems.push({
                    product_id: productId,
                    product_name: productName,
                    material_type: materialType,
                    quantity: quantity,
                    unit_price: unitPrice,
                    total_price: totalPrice
                });
            });

            const orderItemsJSON = JSON.stringify(orderItems);
            document.querySelector("#orderItems").value = orderItemsJSON;

            // Submit the form
            document.querySelector("#orderForm").submit();
        }

        // Attach event listeners for initial elements
        document.addEventListener("DOMContentLoaded", () => {
            document.querySelectorAll(".quantity").forEach(input => {
                input.addEventListener("change", () => updateTotal(input));
            });
            document.querySelectorAll(".material-type").forEach(select => {
                select.addEventListener("change", () => updatePrice(select));
            });
        });

        // Initial call to update the summary
        updateSummary();
        function updatePrice(select) {
    const row = select.closest("tr");
    const unitPrice = parseFloat(select.value);
    row.querySelector(".unit-price").innerText = `₨${unitPrice.toFixed(2)}`;
    const quantity = parseInt(row.querySelector(".quantity").value) || 0;
    const totalPrice = unitPrice * quantity;
    row.querySelector(".total-price").innerText = `₨${totalPrice.toFixed(2)}`;
    updateSummary();
}

function updateTotal(input) {
    const row = input.closest("tr");
    const unitPrice = parseFloat(row.querySelector(".unit-price").innerText.replace("₨", ""));
    const quantity = parseInt(input.value) || 0;
    const totalPrice = unitPrice * quantity;
    row.querySelector(".total-price").innerText = `₨${totalPrice.toFixed(2)}`;
    updateSummary();
}

function updateSummary() {
    let subtotal = 0;
    document.querySelectorAll(".total-price").forEach(price => {
        subtotal += parseFloat(price.innerText.replace("₨", ""));
    });
    console.log("Updated subtotal: ₨" + subtotal.toFixed(2));
}

function removeItem(button) {
    button.closest("tr").remove();
    updateSummary();
}
    </script>
</body>
</html>